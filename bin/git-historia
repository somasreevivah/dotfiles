#! /usr/bin/env bash

FILE="$1"
TMPDIR=$(mktemp -d)

let count=1

for sha in $(git log --format="%H" ${FILE} | tac ) ; do

  TMPFILE=${TMPDIR}/${count}_${FILE}

  cat > ${TMPFILE} <<EOF
${TMPFILE}
 vim: fdm=marker
COMMIT {{{
$(git show ${sha})
}}} COMMIT

EOF

  git show ${sha}:./${FILE} >> ${TMPFILE}

  let count+=1

done

ls -v ${TMPDIR} | xargs -n1 -I FF echo ${TMPDIR}/FF | xargs -n 100 vim

rm -rf ${TMPDIR}

reset

# vim: ft=sh

