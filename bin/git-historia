#! /usr/bin/env bash

FILE="$1"
TMPDIR=$(mktemp -d)

let count=1

for sha in $(git log --format="%H" ${FILE}) ; do

  TMPFILE=${TMPDIR}/${count}_${FILE}

  cat > ${TMPFILE} <<EOF
${TMPFILE}
 vim: fdm=marker
COMMIT {{{
$(git show ${sha})
}}} COMMIT

EOF

  git show ${sha}:./${FILE} >> ${TMPFILE}

  let count+=1

done

find ${TMPDIR} | sort -n -r | grep -v ${TMPDIR}\$ | xargs -n 100 vim

rm -rf ${TMPDIR}

reset

# vim: ft=sh

